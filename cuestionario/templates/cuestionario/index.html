{% extends "cuestionario/base.html" %}

{% block title %}Inicio - {{ trabajador.nombre }}{% endblock %}

{% block content %}
    <section>
        <header>
            <h2>Bienvenid@, {{ trabajador.nombre }} {{ trabajador.apellido_paterno }} {{ trabajador.apellido_materno }}</h2>
            <p><strong>{{ trabajador.cargo.nombre_cargo }}</strong> {{ trabajador.departamento.nombre_departmento }}</p>
        </header>
    </section>

    <div class="features">
        <section>
            <span class="icon solid major fa-user-check"></span>
            <h3>Mi Autoevaluación</h3>
            
            {% if ya_hizo_autoevaluacion %}
                <p style="color: #51ff85;">✅ <strong>Proceso Completado:</strong> Has finalizado todas tus dimensiones.</p>
                <a href="{% url 'autoevaluacion_inicio' trabajador.id_trabajador %}" class="button">Ver estado</a>
            {% else %}
                <p>Presiona el botón para seleccionar la dimensión que deseas evaluar (Organizacional o Funcional).</p>
                <ul class="actions">
                    <li>
                        <a href="{% url 'autoevaluacion_inicio' trabajador.id_trabajador %}" class="button primary">
                            Comenzar Autoevaluación
                        </a>
                    </li>
                </ul>
            {% endif %}
        </section>

        <section>
            <span class="icon solid major fa-info-circle"></span>
            <h3>Información</h3>
            <p>Este proceso consta de dos partes obligatorias. Los resultados serán revisados por tu jefatura directa.</p>
        </section>
    </div>

    {% if es_jefe %}
    <section id="jefatura" class="wrapper style2 spotlights" style="margin-top: 2em; border-radius: 10px; overflow: hidden;">
        <section>
            <div class="content">
                <div class="inner">
                    <h2>Panel de Jefatura</h2>
                    <p>Selecciona a un colaborador para gestionar sus dimensiones de evaluación:</p>
                    
                    <div class="table-wrapper">
                        <table class="alt">
                            <thead>
                                <tr>
                                    <th>Colaborador</th>
                                    <th>Cargo</th>
                                    <th style="text-align: center;">Acción</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for subordinado in equipo %}
                                <tr>
                                    <td style="vertical-align: middle;">{{ subordinado.nombre }} {{ subordinado.apellido_paterno }}</td>
                                    <td style="vertical-align: middle;">{{ subordinado.cargo.nombre_cargo }}</td>
                                    <td style="text-align: center;">
                                        {% if subordinado.ya_evaluado %}
                                            <a href="{% url 'evaluacion_jefe_inicio' trabajador.id_trabajador subordinado.id_trabajador %}" class="button small">
                                                ✅ Finalizado (Ver)
                                            </a>
                                        {% else %}
                                            <a href="{% url 'evaluacion_jefe_inicio' trabajador.id_trabajador subordinado.id_trabajador %}" class="button primary small">
                                                Evaluar Colaborador →
                                            </a>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3">No hay subordinados asignados.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </section>
    {% endif %}

{% endblock %}